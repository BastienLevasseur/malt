<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>MATT WebView</title>

		<!-- Bootstrap -->
		<link href="deps/bootstrap/css/bootstrap.min.css" rel="stylesheet">
		<!-- Theme -->
		<link href='deps/bootswatch/bootstrap.min.css' rel="stylesheet">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>
	<body>
		<h1>Hello, world!</h1>

		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="deps/jquery/jquery.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="deps/bootstrap/js/bootstrap.min.js"></script>
		<!-- EJS system to apply code temples. -->
		<script src="deps/ejs/ejs_production.js"></script>
		
		
		<!-- Top NAV bar -->
		<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#">MATT WebView</a>
					</div>
					<div class="navbar-collapse collapse">
					<ul class="nav navbar-nav navbar-right">
						<li><a href="#">Summary</a></li>
						<li><a href="/">Stack analysis</a></li>
						<li><a href="#">Graphs</a></li>
						<li><a href="#">Help</a></li>
					</ul>
					<!--<form class="navbar-form navbar-right">
						<input type="text" class="form-control" placeholder="Search...">
					</form>-->
				</div>
			</div>
		</div>
		
		<div class="container-fluid">
			<div class="row">
				<div class="col-sm-5 col-md-3 sidebar">
					<div class="btn-group">
						<button type="button" class="btn btn-default glyphicon glyphicon-sort-by-attributes"> </button>
						<button type="button" class="btn btn-default">B</button>
						<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
							Dropdown
							<span class="caret"></span>
						</button>
						<ul class="dropdown-menu">
							<li><a href="#">Dropdown link</a></li>
							<li><a href="#">Dropdown link</a></li>
						</ul>
					</div>
				
					<ul class="nav nav-sidebar" id='matt-func-list'>
					</ul>
				</div>
			</div>
		</div>
		
		<script type='text/javascript'>
			var MATT_POWER = ['','K','M','G','T','P'];
			function mattValue(value)
			{
				var power = 0;
				while (value >= 100)
					value /= 1000;
				return value.toFixed(1);
			}
			
			function mattValueDeco(value)
			{
				var power = 0;
				while (value >= 100)
				{
					power++;
					value /= 1000;
				}
				return MATT_POWER[power];
			}
		
			function mattExtractFunctionList(data)
			{
				var max = 0;
				var sum = 0;
				var res = new Array();
				for(var i in data.funcs)
				{
					var value = data.funcs[i].childs.alloc.sum;
					if (value > max)
						max = value;
					sum += value;
					res.push({'name':i,'value':value});
				}

				res = res.sort(function (a,b) {return (b.value - a.value)});

				return {'data':{'entries':res, 'max':max,'sum':sum}};
			}
		
			function mattUpdateFunctionList()
			{
				var callback = new EJS({url: 'func-list.ejs'}).update('matt-func-list');
				$.getJSON( "flat.json", function( data ) {
					callback(mattExtractFunctionList(data));
				});
			}
		
			$( document ).ready(function() {
				mattUpdateFunctionList();
			});
		</script>
	</body>
</html>
